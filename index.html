function loadSettings() {
            Papa.parse(urls.settings, {
                download: true,
                complete: function(results) {
                    const s = results.data;
                    if(!s || s.length < 3) return;

                    // 1. 精准匹配你的截图位置
                    // s[1] 是 Excel 的第 2 行
                    homeCurrencyLabel = s[1][1] || 'MYR';   // B2: 本币名称
                    const rateValue = parseFloat(s[1][2]);  // C2: 汇率数值 (3.9)
                    
                    // s[2] 是 Excel 的第 3 行
                    foreignCurrencyLabel = s[2][1] || 'USD'; // B3: 外币名称
                    
                    globalExchangeRate = rateValue || 1; 

                    document.getElementById('exchange-info').innerText = `参考汇率: 1 ${foreignCurrencyLabel} = ${globalExchangeRate} ${homeCurrencyLabel}`;
                    
                    // 2. 核心：从第 6 行（index 5）开始读取具体的消费列表
                    const expCont = document.getElementById('expense-list-container');
                    let total = 0;
                    let html = '<div class="expense-card">';
                    
                    // 只读取有金额的行
                    const dataRows = s.slice(5); 
                    dataRows.forEach(r => {
                        const amt = parseFloat(r[1]); // B列: 金额
                        if(!r[0] || isNaN(amt)) return;

                        const homeAmt = amt * globalExchangeRate;
                        total += homeAmt;
                        
                        const cat = r[2] || '其他'; // C列: 分类
                        const icon = icons[cat] || 'fa-wallet';
                        const color = colors[cat] || '#82868B';

                        html += `
                            <div class="expense-row">
                                <div class="category-icon" style="background:${color}20; color:${color}"><i class="fas ${icon}"></i></div>
                                <div class="expense-info"><h4>${r[0]}</h4><p>${cat}</p></div>
                                <div class="expense-amount">
                                    <div class="amount-home">${homeCurrencyLabel} ${homeAmt.toFixed(2)}</div>
                                    <div class="amount-foreign">${amt} ${foreignCurrencyLabel}</div>
                                </div>
                            </div>`;
                    });
                    
                    expCont.innerHTML = html + '</div>';
                    document.getElementById('total-cost').innerText = `${homeCurrencyLabel} ${total.toFixed(2)}`;
                }
            });
        }
